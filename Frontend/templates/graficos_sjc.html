<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planeja SJC - Gráficos</title>

    <link rel="icon" type="image/png" href="{{ url_for('static', filename='images/l1.png') }}">

    <link rel="stylesheet" href="https://stackpath.bootstrapcdn.com/bootstrap/4.5.2/css/bootstrap.min.css">

    <script src="https://cdn.tailwindcss.com"></script>

    <link
        href="https://fonts.googleapis.com/css2?family=Montserrat:ital,wght@0,100..900;1,100..900&family=Poppins&display=swap"
        rel="stylesheet">

    <style>
        /* --- 1. CONFIGURAÇÕES GERAIS --- */

        body {
            font-family: 'Montserrat', sans-serif !important;
            background-color: #f0f2f5;
            overflow-x: hidden;
        }

        /* --- 2. NAVBAR CUSTOMIZADA --- */
        .navbar-custom {
            background-color: #043e79 !important;
            padding: 0.9rem 4rem;
            font-family: 'Poppins', sans-serif;
            display: flex;
            justify-content: space-between;
            align-items: center;
            flex-wrap: wrap;
        }

        /* Animação do LOGO (Restaurada) */
        .brand-animate {
            position: relative;
            display: flex;
            align-items: center;
            transition: transform 0.3s ease;
            text-decoration: none !important;
        }

        .brand-animate::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: 0;
            width: 100%;
            height: 3px;
            background-color: rgb(255, 115, 0);
            transform: scaleX(0);
            transition: transform 0.3s ease;
            border-radius: 5px;
        }

        .brand-animate:hover {
            transform: translateY(-2px);
        }

        .brand-animate:hover::after {
            transform: scaleX(1);
        }

        /* Animação dos LINKS (Restaurada) */
        .nav-link-custom {
            color: white !important;
            font-weight: bold;
            font-size: 18px;
            position: relative;
            padding: 5px 10px;
            text-decoration: none !important;
            transition: transform 0.3s ease;
        }

        .nav-link-custom::after {
            content: '';
            position: absolute;
            left: 0;
            bottom: -2px;
            width: 100%;
            height: 3px;
            background-color: rgb(255, 115, 0);
            transform: scaleX(0);
            transition: transform 0.3s ease;
        }

        .nav-link-custom:hover {
            transform: translateY(-2px);
            color: #fff !important;
        }

        .nav-link-custom:hover::after {
            transform: scaleX(1);
        }

        /* --- 3. MENU MOBILE (Correção do Pisca-Pisca) --- */
        #menuDesktop {
            display: none;
        }

        #menuMobile {
            display: block;
            width: 100%;
            background-color: #043e79;
            overflow: hidden;
            /* Essencial para não piscar */
            max-height: 0;
            /* Começa fechado */
            opacity: 0;
            transition: max-height 0.5s ease-in-out, opacity 0.4s ease-in-out;
            /* Animação suave */
        }

        #menuMobile.open {
            max-height: 300px;
            /* Altura suficiente para abrir */
            opacity: 1;
            padding-bottom: 15px;
            border-top: 1px solid rgba(255, 255, 255, 0.1);
            margin-top: 10px;
        }

        /* Ícone do Menu */
        .toggler-icon {
            width: 30px;
            height: 30px;
            background-image: url("data:image/svg+xml,%3csvg xmlns='http://www.w3.org/2000/svg' width='30' height='30' viewBox='0 0 30 30'%3e%3cpath stroke='rgba%28255, 255, 255, 1%29' stroke-linecap='round' stroke-miterlimit='10' stroke-width='2' d='M4 7h22M4 15h22M4 23h22'/%3e%3c/svg%3e");
        }

        /* Regra para Desktop */
        @media (min-width: 992px) {
            #menuDesktop {
                display: flex !important;
            }

            #btnMenuMobile {
                display: none !important;
            }

            #menuMobile {
                display: none !important;
            }

            /* Garante que não apareça no desktop */
        }

        /* --- 4. CARDS (Sombra Original Restaurada) --- */
        .custom-card {
            background-color: white;
            border-radius: 0.75rem;
            /* Sombra original forte */
            box-shadow: 0 4px 6px -1px rgb(0 0 0 / 0.1), 0 2px 4px -2px rgb(0 0 0 / 0.1);
            padding: 1.5rem;
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out;
            height: 100%;
            /* Garante altura igual no grid */
        }

        .custom-card:hover {
            transform: translateY(-5px);
            /* Sombra mais forte no hover */
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }

        /* --- 5. UTILITÁRIOS --- */
        .chart-container {
            position: relative;
            height: 500px;
            width: 100%;
            background-color: #f9fafb;
            border-radius: 0.5rem;
            overflow: hidden;
        }

        .chart-container iframe {
            width: 100%;
            height: 100%;
            border: none;
        }

        footer img {
            filter: brightness(0) invert(1);
            transition: transform 0.3s;
        }

        footer img:hover {
            transform: scale(1.2);
        }
    </style>
</head>

<body class="antialiased text-gray-800">

    <nav class="navbar-custom">
        <a class="brand-animate" href="{{ url_for('index') }}">
            <img src="{{ url_for('static', filename='images/l6.png') }}" alt="Logo" style="height: 55px;">
        </a>

        <div id="menuDesktop">
            <ul class="nav">
                <li class="nav-item mx-2"><a class="nav-link-custom" href="{{ url_for('index') }}">Home</a></li>
                <li class="nav-item mx-2"><a class="nav-link-custom" href="{{ url_for('sobre') }}">Sobre</a></li>
            </ul>
        </div>

        <button id="btnMenuMobile" type="button" class="btn btn-outline"
            style="border: 1px solid rgba(255,255,255,0.5);">
            <div class="toggler-icon"></div>
        </button>

        <div id="menuMobile">
            <a class="d-block py-3 nav-link-custom text-center" href="{{ url_for('index') }}">Home</a>
            <a class="d-block py-3 nav-link-custom text-center" href="{{ url_for('sobre') }}">Sobre</a>
        </div>
    </nav>

    <div class="container mx-auto p-4 md:p-8">

        <section class="mb-5 text-center">
            <h1 class="text-4xl font-bold text-gray-900">Gráficos</h1>
            <p class="text-lg text-gray-600 mt-4">
                Esta página apresenta um conjunto de gráficos interativos e informativos sobre São José dos Campos.
            </p>
        </section>

        <section class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-5">
            <div class="custom-card text-center">
                <h3 class="h5 text-muted font-weight-bold">População Total</h3>
                <p id="populacao-total" class="text-4xl font-bold text-primary mt-2">697 mil</p>
                <span class="small text-muted">pessoas</span>
            </div>
            <div class="custom-card text-center">
                <h3 class="h5 text-muted font-weight-bold">Densidade Demográfica</h3>
                <p id="densidade-demografica" class="text-4xl font-bold text-primary mt-2">634,03</p>
                <span class="small text-muted">hab/km²</span>
            </div>
            <div class="custom-card text-center">
                <h3 class="h5 text-muted font-weight-bold">Domicílios Ocupados</h3>
                <p id="domicilios-ocupados" class="text-4xl font-bold text-primary mt-2">248 mil</p>
                <span class="small text-muted">domicílios</span>
            </div>
            <div class="custom-card text-center">
                <h3 class="h5 text-muted font-weight-bold">Média de Moradores</h3>
                <p id="media-moradores" class="text-4xl font-bold text-primary mt-2">2,81</p>
                <span class="small text-muted">moradores/domicílio</span>
            </div>
        </section>

        <div class="row justify-content-center mb-5">
            <div class="col-md-6">
                <label for="region-select" class="d-block text-center font-weight-bold mb-2">Selecione uma
                    região:</label>
                <select id="region-select" class="form-control form-control-lg shadow-sm"
                    style="border-radius: 0.5rem;">
                    <option value="sjc">São José dos Campos</option>
                    <option value="Norte">Região Norte</option>
                    <option value="Sul">Região Sul</option>
                    <option value="Leste">Região Leste</option>
                    <option value="Oeste">Região Oeste</option>
                    <option value="Centro">Região Centro</option>
                    <option value="Sudeste">Região Sudeste</option>
                    <option value="São Francisco Xavier">São Francisco Xavier</option>
                </select>
            </div>
        </div>

        <main class="grid grid-cols-1 lg:grid-cols-2 gap-8">
            <div class="custom-card" id="card1">
                <h2 class="h4 font-weight-bold text-center mb-4" id="chart1-title">Carregando...</h2>
                <div class="chart-container"><iframe id="chart1" src=""></iframe></div>
            </div>
            <div class="custom-card" id="card2">
                <h2 class="h4 font-weight-bold text-center mb-4" id="chart2-title">Carregando...</h2>
                <div class="chart-container"><iframe id="chart2" src=""></iframe></div>
            </div>
            <div class="custom-card" id="card3">
                <h2 class="h4 font-weight-bold text-center mb-4" id="chart3-title">Carregando...</h2>
                <div class="chart-container"><iframe id="chart3" src=""></iframe></div>
            </div>
            <div class="custom-card" id="card4">
                <h2 class="h4 font-weight-bold text-center mb-4" id="chart4-title">Carregando...</h2>
                <div class="chart-container"><iframe id="chart4" src=""></iframe></div>
            </div>
            <div class="custom-card" id="card5">
                <h2 class="h4 font-weight-bold text-center mb-4" id="chart5-title">Carregando...</h2>
                <div class="chart-container"><iframe id="chart5" src=""></iframe></div>
            </div>
            <div class="custom-card" id="card6">
                <h2 class="h4 font-weight-bold text-center mb-4" id="chart6-title">Carregando...</h2>
                <div class="chart-container"><iframe id="chart6" src=""></iframe></div>
            </div>
        </main>
    </div>

    <footer class="text-white py-3 px-4 d-flex justify-content-between align-items-center mt-5 font-weight-bold"
        style="background-color: #043e79;">
        <div style="width: 32px;"></div>
        <span>© 2025 Omnidevs, Todos os direitos reservados &copy;</span>
        <a href="https://github.com/OmniDevsOficial/API-Censo-2022/tree/main" target="_blank">
            <img src="{{ url_for('static', filename='images/github.png') }}" alt="Github" style="width: 32px;">
        </a>
    </footer>

    <script>
        document.addEventListener('DOMContentLoaded', () => {
            const btn = document.getElementById('btnMenuMobile');
            const menu = document.getElementById('menuMobile');

            if (btn && menu) {
                btn.addEventListener('click', () => {
                    // Adiciona/Remove a classe 'open' que controla a altura (slide)
                    menu.classList.toggle('open');
                });
            }

            const regionData = {
                'sjc': { name: 'São José dos Campos', charts: [{ id: 'chart1', title: 'Pirâmide Etária 2010', tipo: 'piramide_2010' }, { id: 'chart3', title: 'População por Região', tipo: 'populacao' }, { id: 'chart2', title: 'Pirâmide Etária 2022', tipo: 'piramide_2022' }, { id: 'chart4', title: 'Taxa de Crescimento', tipo: 'taxa_crescimento' }, { id: 'chart5', title: 'Nível de Escolaridade', tipo: 'nivel_escolaridade' }, { id: 'chart6', title: 'Internet por Domicílio', tipo: 'internet_domicilio' }] },
                'Norte': { name: 'Região Norte', charts: [{ id: 'chart1', title: 'População da Região Norte', tipo: 'populacao' }, { id: 'chart2', title: 'População por Bairro - Norte', tipo: 'populacao_bairro' }, { id: 'chart3', title: 'Gráfico 3', tipo: null }, { id: 'chart4', title: 'Gráfico 4', tipo: null }, { id: 'chart5', title: 'Gráfico 5', tipo: null }, { id: 'chart6', title: 'Gráfico 6', tipo: null }] },
                'Sul': { name: 'Região Sul', charts: [{ id: 'chart1', title: 'População da Região Sul', tipo: 'populacao' }, { id: 'chart2', title: 'População por Bairro - Sul', tipo: 'populacao_bairro' }, { id: 'chart3', title: 'Gráfico 3', tipo: null }, { id: 'chart4', title: 'Gráfico 4', tipo: null }, { id: 'chart5', title: 'Gráfico 5', tipo: null }, { id: 'chart6', title: 'Gráfico 6', tipo: null }] },
                'Leste': { name: 'Região Leste', charts: [{ id: 'chart1', title: 'População da Região Leste', tipo: 'populacao' }, { id: 'chart2', title: 'População por Bairro - Leste', tipo: 'populacao_bairro' }, { id: 'chart3', title: 'Gráfico 3', tipo: null }, { id: 'chart4', title: 'Gráfico 4', tipo: null }, { id: 'chart5', title: 'Gráfico 5', tipo: null }, { id: 'chart6', title: 'Gráfico 6', tipo: null }] },
                'Oeste': { name: 'Região Oeste', charts: [{ id: 'chart1', title: 'População da Região Oeste', tipo: 'populacao' }, { id: 'chart2', title: 'População por Bairro - Oeste', tipo: 'populacao_bairro' }, { id: 'chart3', title: 'Gráfico 3', tipo: null }, { id: 'chart4', title: 'Gráfico 4', tipo: null }, { id: 'chart5', title: 'Gráfico 5', tipo: null }, { id: 'chart6', title: 'Gráfico 6', tipo: null }] },
                'Centro': { name: 'Região Centro', charts: [{ id: 'chart1', title: 'População da Região Centro', tipo: 'populacao' }, { id: 'chart2', title: 'População por Bairro - Centro', tipo: 'populacao_bairro' }, { id: 'chart3', title: 'Gráfico 3', tipo: null }, { id: 'chart4', title: 'Gráfico 4', tipo: null }, { id: 'chart5', title: 'Gráfico 5', tipo: null }, { id: 'chart6', title: 'Gráfico 6', tipo: null }] },
                'Sudeste': { name: 'Região Sudeste', charts: [{ id: 'chart1', title: 'População da Região Sudeste', tipo: 'populacao' }, { id: 'chart2', title: 'População por Bairro - Sudeste', tipo: 'populacao_bairro' }, { id: 'chart3', title: 'Gráfico 3', tipo: null }, { id: 'chart4', title: 'Gráfico 4', tipo: null }, { id: 'chart5', title: 'Gráfico 5', tipo: null }, { id: 'chart6', title: 'Gráfico 6', tipo: null }] },
                'São Francisco Xavier': { name: 'São Francisco Xavier', charts: [{ id: 'chart1', title: 'População - São Francisco Xavier', tipo: 'populacao_bairro' }, { id: 'chart2', title: 'Gráfico 2', tipo: null }, { id: 'chart3', title: 'Gráfico 3', tipo: null }, { id: 'chart4', title: 'Gráfico 4', tipo: null }, { id: 'chart5', title: 'Gráfico 5', tipo: null }, { id: 'chart6', title: 'Gráfico 6', tipo: null }] }
            };

            function updateDashboard(regionKey) {
                const data = regionData[regionKey];
                if (!data) return;
                data.charts.forEach(chart => {
                    const iframeElement = document.getElementById(chart.id);
                    const titleElement = document.getElementById(chart.id + '-title');
                    const cardElement = document.getElementById('card' + chart.id.replace('chart', ''));
                    if (titleElement) titleElement.textContent = chart.title;
                    if (iframeElement) {
                        iframeElement.removeAttribute('src'); iframeElement.removeAttribute('srcdoc');
                        if (chart.tipo) { if (cardElement) cardElement.removeAttribute('hidden'); iframeElement.src = `/grafico/${regionKey}/${chart.tipo}`; }
                        else { if (cardElement) cardElement.setAttribute('hidden', 'true'); }
                    }
                });
            }
            const selectElement = document.getElementById('region-select');
            if (selectElement) { updateDashboard(selectElement.value); selectElement.addEventListener('change', (event) => { updateDashboard(event.target.value); }); }
            else { updateDashboard('sjc'); }
        });
    </script>
</body>

</html>