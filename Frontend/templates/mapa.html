<!DOCTYPE html>
<html lang="pt-BR">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Planeja SJC</title>
    <link rel="stylesheet" href="{{ url_for('static', filename='style.css') }}">
    <!-- Linkamento da estilazação CSS -->
    <link rel="icon" type="image/png" href="static/images/brasao_64x64.png">
    <script src="https://cdn.tailwindcss.com"></script> <!--Aplicação do tailwind-->
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>  <!--biblioteca charts.js-->
</head>

<body>
    <header>
        <a href="./Index.html">
            <img id="logo" src="static/images/logo.png" alt="logo">
        </a>
        <nav>
            <ul class="menu">
                <li><a href="{{ url_for('index') }}">Home</a></li>
                <li><a href="{{ url_for('sobre') }}">Sobre</a></li>
            </ul>
        </nav>
    </header>
    <main>
        <div class="max-w-7xl mx-auto p-4 md:p-8">
        <!--Título + parágrafo incial-->
        <section>
            <h1 class="text-4xl font-bold text-blue-800">Panorama do Censo 2022</h1>
                <p class="text-lg text-gray-600 mt-2">Esta página apresenta uma análise visual dos dados do Censo, por meio de gráficos
                interativos e informativos.Aqui, é possível explorar estatísticas sobre população, educação, renda,habitação e outros 
                indicadores sociais.Os gráficos foram desenvolvidos para facilitar a compreensão dos principais resultados do 
                levantamento, permitindo identificar tendências, comparações e transformações demográficas ao longo do tempo.</p>
        </section>
        <!--Filtro-->
        <section class="filtro">
            <div class="mt-8 max-w-md mx-auto mb-8">
                <label for="region-select" class="block text-sm font-medium text-gray-700 mb-2 text-center"
                >Selecione uma localidade:</label>
                <select id="region-select" class="custom-select block w-full px-4 py-3 text-base text-gray-900 bg-white border
                    border-gray-300 rounded-md shadow-sm focus:outline-none focus:ring-blue-500 focus:border-blue-500">
                        <option value="São José dos Campos">São José dos Campos</option>
                        <option value="Norte">Norte</option>
                        <option value="Leste">Leste</option>
                        <option value="Oeste">Oeste</option>
                        <option value="Sul">Sul</option>
                        <option value="Centro">Centro</option>
                </select>
            </div>
        </section>
        <!--Seção dos indicadores-->
        <section id="indicator-cards" class="grid grid-cols-1 md:grid-cols-2 lg:grid-cols-4 gap-6 mb-10">
            <div class="card text-center">
                <h3 class="text-lg font-semibold text-gray-500">População Total</h3>
                <p id="populacao-total" class="text-4xl font-bold text-blue-600 mt-2">724 mil</p>
                <span class="text-sm text-gray-500">pessoas</span>
            </div>
            <div class="card text-center">
                <h3 class="text-lg font-semibold text-gray-500">Densidade Demográfica</h3>
                <p id="densidade-demografica" class="text-4xl font-bold text-blue-600 mt-2">634,4</p>
                <span class="text-sm text-gray-500">hab/km²</span>
            </div>
            <div class="card text-center">
                <h3 class="text-lg font-semibold text-gray-500">Domicílios Ocupados</h3>
                <p id="domicilios-ocupados" class="text-4xl font-bold text-blue-600 mt-2">248 mil</p>
                 <span class="text-sm text-gray-500">domicílios</span>
            </div>
            <div class="card text-center">
                <h3 class="text-lg font-semibold text-gray-500">Média de Moradores</h3>
                <p id="media-moradores" class="text-4xl font-bold text-blue-600 mt-2">2,81</p>
                <span class="text-sm text-gray-500">moradores/domicílio</span>
            </div>
        </section>
        <main class="grid grid-cols-1 lg:grid-cols-2 gap-8">
                <!-- Gráfico de Barras Grande -->
                <div class="card col-span-1 lg:col-span-2">
                    <h2 class="text-xl font-bold mb-4 text-center">População por Região</h2>
                    <div class="relative h-96">
                        <canvas id="graficoGrande"></canvas>
                    </div>
                </div>
                <!--Dois gráficos menores lado a lado -->
                <div class="card">
                    <h2 class="text-xl font-bold mb-4 text-center">Distribuição de Domicílios</h2>
                    <div class="relative h-80">
                        <canvas id="tipoDomicilioChart"></canvas>
                    </div>
                </div>

                <div class="card">
                    <h2 class="text-xl font-bold mb-4 text-center">População por Localidade</h2>
                    <div class="relative h-80">
                        <canvas id="populacaoLocalidadeChart"></canvas>
                    </div>
                </div>
                <!--Gráfico de Pirâmide Etária -->
                <div class="card col-span-1 lg:col-span-2">
                    <h2 class="text-xl font-bold mb-4 text-center">Pirâmide Etária</h2>
                    <div class="relative h-96">
                        <canvas id="piramideEtariaChart"></canvas>
                    </div>
                </div>

        </main>
            <footer class="text-center mt-12 text-gray-500 text-sm">
            <p>Dados simulados com base nos resultados do Censo Demográfico 2022.</p>
            <p>Este é um projeto de demonstração e não representa uma fonte oficial de dados.</p>
        </footer>
    </main>
    <script>
                document.addEventListener('DOMContentLoaded', () => {
                    // --- ESTRUTURA DE DADOS ---
                    const censusData = {
                        'São José dos Campos': {
                            name: "São José dos Campos",
                            populacao: "203,1 mi", densidade: "23,8", domicilios: "72,4 mi", mediaMoradores: "2,79",
                            piramideHomens: [7.1, 7.2, 7.4, 7.5, 8.1, 8.3, 8.4, 8.5, 8.1, 7.5, 6.9, 6.1, 5.2, 4.1, 3.1, 2.2, 2.5],
                            piramideMulheres: [6.8, 6.9, 7.1, 7.3, 7.9, 8.1, 8.2, 8.4, 8.0, 7.5, 7.0, 6.3, 5.6, 4.6, 3.7, 2.8, 3.5],
                            localidadeTitle: "População por Grande Região",
                            localidadeLabels: ['Sudeste', 'Nordeste', 'Sul', 'Norte', 'Centro-Oeste'],
                            localidadeData: [84.8, 54.6, 29.9, 17.3, 16.2],
                            domicilioLabels: ['Casa', 'Apartamento', 'Cômodo'],
                            domicilioData: [84.6, 13.5, 1.9],
                        },
                        'Norte': {
                            name: "Norte",
                            populacao: "17,3 mi", densidade: "4,5", domicilios: "5,7 mi", mediaMoradores: "3,15",
                            piramideHomens: [0.9, 1.0, 1.0, 0.9, 0.9, 0.8, 0.8, 0.7, 0.6, 0.5, 0.4, 0.3, 0.2, 0.2, 0.1, 0.1, 0.1],
                            piramideMulheres: [0.9, 0.9, 1.0, 0.9, 0.9, 0.8, 0.8, 0.7, 0.6, 0.5, 0.4, 0.3, 0.3, 0.2, 0.1, 0.1, 0.1],
                            localidadeTitle: "População por UF (Norte)",
                            localidadeLabels: ['PA', 'AM', 'RO', 'AC', 'AP', 'TO', 'RR'],
                            localidadeData: [8.1, 3.9, 1.6, 0.8, 0.7, 1.5, 0.6],
                            domicilioLabels: ['Casa', 'Apartamento', 'Cômodo'],
                            domicilioData: [92.1, 5.8, 2.1],
                        },
                        'Sul': {
                            name: "Sul",
                            populacao: "29,9 mi",
                            densidade: "48,1",
                            domicilios: "10,5 mi",
                            mediaMoradores: "2,75",
                            piramideHomens: [6.1, 6.3, 6.4, 6.5, 6.7, 6.9, 7.0, 7.2, 7.0, 6.5, 6.0, 5.2, 4.3, 3.3, 2.5, 1.8, 2.0],
                            piramideMulheres: [5.9, 6.1, 6.3, 6.4, 6.6, 6.8, 7.0, 7.1, 7.0, 6.6, 6.1, 5.5, 4.8, 3.8, 3.0, 2.2, 2.6],
                            localidadeTitle: "População por UF (Sul)",
                            localidadeLabels: ['PR', 'RS', 'SC'],
                            localidadeData: [11.4, 10.9, 7.6],
                            domicilioLabels: ['Casa', 'Apartamento', 'Cômodo'],
                            domicilioData: [83.2, 15.4, 1.4],
                        },
                        'Leste': {
                            name: "Leste",
                            populacao: "54,6 mi",
                            densidade: "36,8",
                            domicilios: "18,9 mi",
                            mediaMoradores: "2,9",
                            piramideHomens: [8.0, 8.2, 8.3, 8.4, 8.5, 8.3, 8.1, 7.9, 7.6, 7.0, 6.2, 5.4, 4.5, 3.5, 2.5, 1.8, 2.0],
                            piramideMulheres: [7.9, 8.1, 8.2, 8.4, 8.5, 8.4, 8.2, 8.0, 7.8, 7.2, 6.6, 5.8, 5.0, 4.0, 3.1, 2.3, 2.7],
                            localidadeTitle: "População por UF (Nordeste)",
                            localidadeLabels: ['BA', 'PE', 'CE', 'MA', 'PB', 'RN', 'PI', 'SE', 'AL'],
                            localidadeData: [14.9, 9.7, 9.2, 7.1, 4.0, 3.5, 3.3, 2.4, 3.0],
                            domicilioLabels: ['Casa', 'Apartamento', 'Cômodo'],
                            domicilioData: [86.7, 11.5, 1.8],
                        },
                        'Centro': {
                            name: "Centro",
                            populacao: "16,2 mi",
                            densidade: "10,1",
                            domicilios: "5,8 mi",
                            mediaMoradores: "2,8",
                            piramideHomens: [2.2, 2.3, 2.4, 2.3, 2.3, 2.2, 2.1, 2.0, 1.9, 1.7, 1.5, 1.3, 1.1, 0.9, 0.8, 0.6, 0.7],
                            piramideMulheres: [2.1, 2.2, 2.3, 2.2, 2.3, 2.2, 2.1, 2.0, 1.9, 1.7, 1.5, 1.3, 1.1, 0.9, 0.8, 0.6, 0.8],
                            localidadeTitle: "População por UF (Centro-Oeste)",
                            localidadeLabels: ['DF', 'GO', 'MT', 'MS'],
                            localidadeData: [3.2, 7.1, 3.7, 2.2],
                            domicilioLabels: ['Casa', 'Apartamento', 'Cômodo'],
                            domicilioData: [81.9, 16.5, 1.6],
                        },
                        'Oeste': {
                            name: "Oeste",
                            populacao: "15,8 mi",
                            densidade: "9,3",
                            domicilios: "5,4 mi",
                            mediaMoradores: "2,85",
                            piramideHomens: [2.0, 2.1, 2.2, 2.3, 2.4, 2.3, 2.2, 2.1, 2.0, 1.8, 1.6, 1.4, 1.2, 1.0, 0.8, 0.6, 0.7],
                            piramideMulheres: [2.0, 2.1, 2.2, 2.3, 2.4, 2.3, 2.2, 2.1, 2.0, 1.9, 1.7, 1.5, 1.3, 1.1, 0.9, 0.7, 0.8],
                            localidadeTitle: "População por UF (Oeste)",
                            localidadeLabels: ['MT', 'MS', 'GO', 'DF'],
                            localidadeData: [3.5, 2.7, 7.0, 2.6],
                            domicilioLabels: ['Casa', 'Apartamento', 'Cômodo'],
                            domicilioData: [82.3, 16.0, 1.7],
                        },

                    };
                    // --- INSTÂNCIAS DOS GRÁFICOS ---
                    let piramideChart, graficoGrandeChart, tipoDomicilioChart;
                    const ageLabels = ['0-4', '5-9', '10-14', '15-19', '20-24', '25-29', '30-34', '35-39', '40-44', '45-49', '50-54', 
                                        '55-59', '60-64', '65-69', '70-74', '75-79', '80+'];
                    //--- Função para inicializar os gráficos
                    function createCharts() {
                        const initialData = censusData['São José dos Campos'];

                        // Gráfico de População por Região
                        graficoGrandeChart = new Chart(document.getElementById('graficoGrande'), {
                            type: 'bar',
                            data: { labels: initialData.localidadeLabels, datasets: [{ label: 'População (milhões)',
                            data: initialData.localidadeData, backgroundColor: '#3B82F6' }] },
                            options: { responsive: true, maintainAspectRatio: false, plugins: { legend: { display: false } }, scales: { y: { beginAtZero: true } } }
                        });

                        // Gráfico de Distribuição de Domicílios
                        tipoDomicilioChart = new Chart(document.getElementById('tipoDomicilioChart'), {
                            type: 'bar',
                            data: { labels: initialData.domicilioLabels, datasets: [{ label: '% de Domicílios',
                            data: initialData.domicilioData, backgroundColor: ['#8B5CF6', '#F97316', '#10B981'] }] },
                            options: { responsive: true, maintainAspectRatio: false, indexAxis: 'y', plugins: { legend: { display: false } }, scales: { x: { beginAtZero: true } } }
                        });
                        // População por Localidade 
                        const populacaoCtx = document.getElementById('populacaoLocalidadeChart').getContext('2d');
                        populacaoLocalidadeChart = new Chart(populacaoCtx, {
                            type: 'bar',
                            data: { 
                                labels: initialData.localidadeLabels, 
                                datasets: [{ label: 'População (milhões)', data: initialData.localidadeData, backgroundColor: '#3B82F6' }] 
                            },
                            options: { 
                                responsive: true, 
                                maintainAspectRatio: false, 
                                plugins: { legend: { display: false } }, 
                                scales: { y: { beginAtZero: true } } 
                            } 
                        });
                        // Pirâmide Etária
                        piramideChart = new Chart(document.getElementById('piramideEtariaChart'), {
                            type: 'bar',
                            data: {
                                labels: ageLabels.slice().reverse(),
                                datasets: [
                                    { label: 'Homens', data: initialData.piramideHomens.slice().reverse().map(v => -v), backgroundColor: 'rgba(54, 162, 235, 0.8)' },
                                    { label: 'Mulheres', data: initialData.piramideMulheres.slice().reverse(), backgroundColor: 'rgba(255, 99, 132, 0.8)' }
                                ]
                            },
                            options: {
                                responsive: true, maintainAspectRatio: false, indexAxis: 'y',
                                scales: { x: { stacked: false, ticks: { callback: v => Math.abs(v) + ' mi' }, title: { display: true, text: 'População (milhões)' } },
                                        y: { stacked: true, title: { display: true, text: 'Faixa Etária' } } },
                                plugins: { tooltip: { callbacks: { label: ctx => `${ctx.dataset.label}: ${Math.abs(ctx.parsed.x).toFixed(2)} mi` } }, legend: { position: 'top' } }
                            }
                        });
                    }

                    function updateDashboard(regionKey) {
                        const data = censusData[regionKey];
                        if (!data) return console.warn('Região não encontrada:', regionKey);

                        // Atualiza cards
                        document.getElementById('populacao-total').textContent = data.populacao;
                        document.getElementById('densidade-demografica').textContent = data.densidade;
                        document.getElementById('domicilios-ocupados').textContent = data.domicilios;
                        document.getElementById('media-moradores').textContent = data.mediaMoradores;
                        document.getElementById('populacao-localidade-title').textContent = data.localidadeTitle;

                        // Atualiza gráficos
                        graficoGrandeChart.data.labels = data.localidadeLabels;
                        graficoGrandeChart.data.datasets[0].data = data.localidadeData;

                        tipoDomicilioChart.data.datasets[0].data = data.domicilioData;
                        
                        populacaoLocalidadeChart.data.labels = data.localidadeLabels; 
                        populacaoLocalidadeChart.data.datasets[0].data = data.localidadeData;

                        piramideChart.data.datasets[0].data = data.piramideHomens.slice().reverse().map(v => -v);
                        piramideChart.data.datasets[1].data = data.piramideMulheres.slice().reverse();

                        graficoGrandeChart.update();
                        tipoDomicilioChart.update();
                        piramideChart.update();
                        populacaoLocalidadeChart.update(); 
                    }

                    createCharts();
                    updateDashboard(document.getElementById('region-select').value);

                    document.getElementById('region-select').addEventListener('change', (e) => updateDashboard(e.target.value));
                });
</script>

</body>

</html>